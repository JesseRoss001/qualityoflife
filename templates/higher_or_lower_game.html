<!DOCTYPE html>
<html>

<head>
    <title>Hi Low </title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">
<style>
/* Base styling for the game container */
#game {
    background-color: #f0f8ff; /* Light blue background */
    border-radius: 15px;
    padding: 20px;
    max-width: 600px;
    margin: 20px auto;
    text-align: center;
}

/* Styling for the question */
#question {
    font-size: 1.5em;
    color: #333333;
    margin-bottom: 20px;
}

/* Styling for the options buttons */
#option1, #option2 {
    background-color: #4CAF50; /* Green background */
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 1.2em;
    margin: 5px;
    transition: background-color 0.3s;
}

#option1:hover, #option2:hover {
    background-color: #45a049;
}

/* Styling for the score display */
#score {
    font-size: 1.3em;
    color: #ff4500; /* Orange color for score */
    margin-top: 20px;
}
</style>
</head>
<body>
<h2>Higher or Lower Game</h2>
<div id="game">
    <div id="question"></div>
    <button id="option1">Country 1</button>
    <button id="option2">Country 2</button>
    <p id="score">Score: 0</p>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM fully loaded and parsed');
        try {
            let countries = JSON.parse('{{ countries|safe }}');
            console.log('Countries data:', countries);
            let score = 0;
            let currentQuestionIndex = 0;
    
            function displayQuestion() {
                console.log('Displaying question for index:', currentQuestionIndex);
                if (currentQuestionIndex < countries.length - 1) {
                    let country1 = countries[currentQuestionIndex];
                    let country2 = countries[currentQuestionIndex + 1];
                    console.log('Current countries:', country1, country2);
    
                    if (!country1 || !country2) {
                        console.error('One of the countries is undefined.');
                        return;
                    }
    
                    if (!country1.fields || !country2.fields) {
                        console.error('Country fields are undefined.');
                        return;
                    }
    
                    if (!('category' in country1.fields)) {
                        console.error('Category not found in country1 fields');
                        return;
                    }
    
                    let attribute = country1.fields.category;
                    let attributeName = attribute.replace(/_/g, ' ');
                    console.log('Attribute:', attribute, 'Attribute Name:', attributeName);
    
                    document.getElementById('question').innerHTML = 
                        `Does ${country1.fields.country_or_region} have a higher ${attributeName} than ${country2.fields.country_or_region}?`;
                    console.log('Question set:', document.getElementById('question').innerHTML);
    
                    document.getElementById('option1').onclick = function() { checkAnswer(country1, country2, attribute); };
                    document.getElementById('option2').onclick = function() { checkAnswer(country2, country1, attribute); };
                } else {
                    alert('Game Over. Your score: ' + score);
                    score = 0;
                    currentQuestionIndex = 0;
                    console.log('Game over, resetting score and index');
                }
            }
    
            function checkAnswer(selectedCountry, otherCountry, attribute) {
                console.log('Checking answer...');
                if (selectedCountry.fields[attribute] > otherCountry.fields[attribute]) {
                    score++;
                    console.log('Correct answer, new score:', score);
                    alert('Correct!');
                } else {
                    console.log('Incorrect answer');
                    alert('Incorrect!');
                }
                currentQuestionIndex += 2;
                updateScore();
                displayQuestion();
            }
    
            function updateScore() {
                console.log('Updating score...');
                document.getElementById('score').innerHTML = 'Score: ' + score;
                console.log('Score updated:', document.getElementById('score').innerHTML);
            }
    
            displayQuestion();
        } catch (error) {
            console.error('Caught error:', error);
        }
    });
    </script>
</body>
</html>
